<div class="col1">
    <div class="name">
        <img class="name" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/name.png"><br />
        <input type="text" name="attr_character" class="character-name" />
    </div>
    <div class="attitude">
        <img class="attitude" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/attitude.png"><br />
        <input type="text" name="attr_attitude" class="attitude" />
    </div><br />
    <div class="class-select">
        <span class="archetype">
            <select name="attr_archetype" class="archetype">
                <option value="blank">{Archetype}</option>
                <option value="augmented">The Augmented</option>
                <option value="civilian">The Civilian</option>
                <option value="leader">The Leader</option>
                <option value="muscle">The Muscle</option>
                <option value="scientist">The Scientist</option>
                <option value="specialist">The Specialist</option>
                <option value="stowaway">The Stowaway</option>
                <option value="technician">The Technician</option>
            </select>
        </span>

        <!-- Used for class switching -->
        <input type="hidden" name="attr_archetype" class="archetype-switch" />

        <span class="variant augmented">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="augmentedBase">Base</option>
                <option value="almostHuman">The Almost-Human</option>
                <option value="construct">The Construct</option>
                <option value="cyborg">The Cyborg</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="augmented1">Head: +0 Hand: +2 Heart: +0 Group: +1 Tech: +1</option>
                <option value="augmented2">Head: +2 Hand: +1 Heart: +0 Group: -2 Tech: +1</option>
                <option value="augmented3">Head: +1 Hand: +2 Heart: -1 Group: +0 Tech: -1</option>
                <option value="augmented4">Head: -1 Hand: +2 Heart: -2 Group: +2 Tech: +0</option>
                <option value="augmented5">Head: +1 Hand: +1 Heart: +0 Group: +1 Tech: +0</option>
            </select>
        </span>
        <span class="variant civilian">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="civilianBase">Base</option>
                <option value="entertainer">The Entertainer</option>
                <option value="homesteader">The Homesteader</option>
                <option value="merchant">The Merchant</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="civilian1">Head: +1 Hand: +0 Heart: +2 Group: +0 Tech: -1</option>
                <option value="civilian2">Head: +0 Hand: +1 Heart: +2 Group: +0 Tech: -1</option>
                <option value="civilian3">Head: +0 Hand: +0 Heart: +2 Group: +1 Tech: +1</option>
                <option value="civilian4">Head: -1 Hand: -1 Heart: +1 Group: +2 Tech: +0</option>
                <option value="civilian5">Head: +1 Hand: -2 Heart: +0 Group: +2 Tech: +1</option>
            </select>
        </span>
        <span class="variant leader">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="leaderBase">Base</option>
                <option value="commander">The Commander</option>
                <option value="diplomat">The Diplomat</option>
                <option value="shepherd">The Shepherd</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="leader1">Head: +2 Hand: +0 Heart: +0 Group: +1 Tech: +1</option>
                <option value="leader2">Head: +2 Hand: +0 Heart: +1 Group: +0 Tech: +1</option>
                <option value="leader3">Head: -2 Hand: +2 Heart: -1 Group: +2 Tech: +0</option>
                <option value="leader4">Head: +1 Hand: +0 Heart: +2 Group: +2 Tech: -1</option>
                <option value="leader5">Head: -1 Hand: +2 Heart: +2 Group: -1 Tech: +0</option>
            </select>
        </span>
        <span class="variant muscle">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="muscleBase">Base</option>
                <option value="exMarine">The Ex-Marine</option>
                <option value="miner">The Miner</option>
                <option value="security">The Security</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="muscle1">Head: +0 Hand: +2 Heart: +2 Group: -2 Tech: +0</option>
                <option value="muscle2">Head: +1 Hand: +2 Heart: +0 Group: +0 Tech: -1</option>
                <option value="muscle3">Head: +2 Hand: +1 Heart: +0 Group: -1 Tech: -1</option>
                <option value="muscle4">Head: -1 Hand: +2 Heart: +2 Group: +1 Tech: -2</option>
                <option value="muscle5">Head: +2 Hand: +0 Heart: -1 Group: +2 Tech: +0</option>
            </select>
        </span>
        <span class="variant scientist">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="scientistBase">Base</option>
                <option value="biologist">The Biologist</option>
                <option value="chemist">The Chemist</option>
                <option value="medic">The Medic</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="scientist1">Head: +2 Hand: -2 Heart: -1 Group: +1 Tech: +1</option>
                <option value="scientist2">Head: +2 Hand: +0 Heart: -1 Group: +1 Tech: +2</option>
                <option value="scientist3">Head: +1 Hand: +1 Heart: +0 Group: -1 Tech: +1</option>
                <option value="scientist4">Head: +0 Hand: -1 Heart: +2 Group: -1 Tech: +2</option>
                <option value="scientist5">Head: -1 Hand: +1 Heart: +2 Group: -1 Tech: +2</option>
            </select>
        </span>
        <span class="variant specialist">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="specialistBase">Base</option>
                <option value="academic">The Academic</option>
                <option value="pilot">The Pilot</option>
                <option value="weaponsExpert">The Weapons Expert</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="specialist1">Head: +2 Hand: +0 Heart: -1 Group: -1 Tech: +2</option>
                <option value="specialist2">Head: +1 Hand: -1 Heart: +0 Group: +0 Tech: +2</option>
                <option value="specialist3">Head: +2 Hand: +1 Heart: +0 Group: -2 Tech: +0</option>
                <option value="specialist4">Head: +0 Hand: +2 Heart: -2 Group: +0 Tech: +2</option>
                <option value="specialist5">Head: -2 Hand: +2 Heart: +1 Group: +1 Tech: +0</option>
            </select>
        </span>
        <span class="variant stowaway">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="stowawayBase">Base</option>
                <option value="criminal">The Criminal</option>
                <option value="kid">The Kid</option>
                <option value="survivor">The Survivor</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="stowaway1">Head: +2 Hand: +0 Heart: +1 Group: +0 Tech: -1</option>
                <option value="stowaway2">Head: +0 Hand: +2 Heart: +1 Group: -1 Tech: -1</option>
                <option value="stowaway3">Head: -1 Hand: +1 Heart: +2 Group: +0 Tech: -1</option>
                <option value="stowaway4">Head: +2 Hand: +0 Heart: +2 Group: -1 Tech: -2</option>
                <option value="stowaway5">Head: +0 Hand: +2 Heart: -1 Group: -2 Tech: +2</option>
            </select>
        </span>
        <span class="variant technician">
            <select name="attr_variant" class="variant">
                <option value="blank">{Variant}</option>
                <option value="technicianBase">Base</option>
                <option value="engineer">The Engineer</option>
                <option value="hacker">The Hacker</option>
                <option value="mechanic">The Mechanic</option>
            </select>
            <br />
            <select name="attr_skill_points" class="skill-points">
                <option value="blank">Skill Points</option>
                <option value="technician1">Head: +2 Hand: +0 Heart: -1 Group: +0 Tech: +2</option>
                <option value="technician2">Head: +1 Hand: -1 Heart: +0 Group: +0 Tech: +2</option>
                <option value="technician3">Head: +3 Hand: -1 Heart: -1 Group: +0 Tech: +1</option>
                <option value="technician4">Head: +1 Hand: +1 Heart: +1 Group: +0 Tech: +0</option>
                <option value="technician5">Head: -2 Hand: +1 Heart: +1 Group: +0 Tech: +1</option>
            </select>
        </span>
    </div>
    <div class="appearance">
        <img class="space" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/appearance.png"><br />
        <textarea name="attr_appearance" class="attr-appearance"></textarea>
    </div>
    <div class="space">
        <img class="space"src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/space.png"><br />
        <textarea name="attr_space" class="attr-space"></textarea>
    </div>
    <div class="notes">
        <img class="space" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/notes.png"><br />
        <textarea name="attr_notes" class="attr-notes"></textarea>
    </div>
</div>
<div class='col2'>
    <div class="stats">
        <img class="statblock" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/stats.png">
        <span class="head-text">Planning<br />Intelligence</span>
        <input type="text" name="attr_head" class="head" />
        <span class="hand-text">Strength<br />Combat</span>
        <input type="text" name="attr_hand" class="hand" />
        <span class="heart-text">Empathy<br />Stability</span>
        <input type="text" name="attr_heart" class="heart" />
        <span class="group-text">Negotiation<br />Networking</span>
        <input type="text" name="attr_group" class="group" />
        <span class="tech-text">Abilities<br />Use Items</span>
        <input type="text" name="attr_tech" class="tech" />
    </div>
    <br />
    <div class="intuition">
        <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/intuition.png"><br />
        <p class="intuition-description">Remove an Intuition to change a roll to an Incredible Success
            or to avoid all harm in one event.</p>
        <div class="intuition-tracker">
            <span>GOOD</span>
            <button type="action" name="act_intuition_1" class="intuition-selector"></button>
            <button type="action" name="act_intuition_2" class="intuition-selector"></button>
            <button type="action" name="act_intuition_3" class="intuition-selector"></button>
            <button type="action" name="act_intuition_4" class="intuition-selector"></button>
            <button type="action" name="act_intuition_5" class="intuition-selector"></button>
            <button type="action" name="act_intuition_6" class="intuition-selector"></button>
            <button type="action" name="act_intuition_7" class="intuition-selector"></button>
            <input type="checkbox" name="attr_intuition1" class="intuition-display" />
            <input type="checkbox" name="attr_intuition2" class="intuition-display" />
            <input type="checkbox" name="attr_intuition3" class="intuition-display" />
            <input type="checkbox" name="attr_intuition4" class="intuition-display" />
            <input type="checkbox" name="attr_intuition5" class="intuition-display" />
            <input type="checkbox" name="attr_intuition6" class="intuition-display" />
            <input type="checkbox" name="attr_intuition7" class="intuition-display" />
            <span class="done-for">DONE FOR</span>
        </div>
    </div>
    <div class="harm-stress">
        <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/harmstress.png"><br />
        <p class="harm-description">Mark a harm when you’re injured. At 5 harm you are unstable.</p>
        <div class="harm-tracker">
            <span>HEALTHY</span>
            <button type="action" name="act_harm_1" class="harm-selector"></button>
            <button type="action" name="act_harm_2" class="harm-selector"></button>
            <button type="action" name="act_harm_3" class="harm-selector"></button>
            <button type="action" name="act_harm_4" class="harm-selector"></button>
            <button type="action" name="act_harm_5" class="harm-selector"></button>
            <button type="action" name="act_harm_6" class="harm-selector"></button>
            <button type="action" name="act_harm_7" class="harm-selector"></button>
            <input type="checkbox" name="attr_harm1" class="harm-display" />
            <input type="checkbox" name="attr_harm2" class="harm-display" />
            <input type="checkbox" name="attr_harm3" class="harm-display" />
            <input type="checkbox" name="attr_harm4" class="harm-display" />
            <input type="checkbox" name="attr_harm5" class="harm-display" />
            <input type="checkbox" name="attr_harm6" class="harm-display" />
            <input type="checkbox" name="attr_harm7" class="harm-display" />
            <span class="dying">DYING</span>
        </div>
        <br /><br />
        <p class="stress-description">Mark a stress when directed. Erase a mark after downtime.
            After the 5th stress mark, you are panicked.</p>
        <div class="stress-tracker">
            <span>ALRIGHT</span>
            <button type="action" name="act_stress_1" class="stress-selector"></button>
            <button type="action" name="act_stress_2" class="stress-selector"></button>
            <button type="action" name="act_stress_3" class="stress-selector"></button>
            <button type="action" name="act_stress_4" class="stress-selector"></button>
            <button type="action" name="act_stress_5" class="stress-selector"></button>
            <input type="checkbox" name="attr_stress1" class="stress-display" />
            <input type="checkbox" name="attr_stress2" class="stress-display" />
            <input type="checkbox" name="attr_stress3" class="stress-display" />
            <input type="checkbox" name="attr_stress4" class="stress-display" />
            <input type="checkbox" name="attr_stress5" class="stress-display" />
            <span class="exhausted">EXHAUSTED</span>
        </div>
    </div>
    <div class="scars">
        <img class="scars" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/scars.png"><br />
        <textarea name="attr_scars" class="attr-scars"></textarea>
    </div>
    <div class="moves">
        <img class="moves" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/moves.png"><br />
        <input type="hidden" name="attr_variant" class="moveset-switch" />
        <div class="augmented-moveset">
            <input type="hidden" name="attr_move_limit" class="move-limit" />
            <span class="move-default">Pick two:</span><br />
            <input type="checkbox" name="attr_move1" class="move move1" />
            <span class="move"><b>With Your Special Eyes:</b> They definitely had your brand when you upgraded your visual input. With your augmented eyes, you can see in near total darkness, and get a +1 when surveying a scene in bad lighting.</span>
            <br /><br />
            <input type="checkbox" name="attr_move2" class="move move2" />
            <span class="move"><b>Volume Control:</b> People talk, and you listen. You can control your hearing to hear very quiet sounds or to filter out very loud ones within 100 feet.</span>
            <br /><br />
            <input type="checkbox" name="attr_move3" class="move move3" />
            <span class="move"><b>Zoom Zoom:</b> You paid for the latest light-weight skeletal upgrades because you just gotta go fast. You can move very quickly and get a +1 to Act Under Fire when dodging enemy attacks.</span>
            <br /><br />
            <input type="checkbox" name="attr_move4" class="move move4" />
            <span class="move"><b>Fursona:</b> The latest augmentation techniques enhance your skin to withstand dangerous temperatures. If you pick <b>fur</b>, you are impervious to cold down to -30°F. If you pick <b>scales</b>, you are impervious to heat up to 120°F. Facial reconstruction to match augment choice included.</span>
        </div>

    </div>
</div>

<script type="text/worker">

    // Values for the trackers
    const intuitionValues = ["1","2","3","4","5","6","7"];
    const harmValues = ["1","2","3","4","5","6","7"];
    const stressValues =  ["1","2","3","4","5"];

    // Descriptions for the space field
    const spaceInfo = {
        augmentedBase:  "OBSERVATION DECK - A place to look, to wonder, to feel small, to contemplate.",

        civilianBase:   "COMMON ROOM - A place to gather, to bond, to play, to relax, to reassure.",
        homesteader:    "GREENHOUSE - A place to grow, to tend, to thrive, to enjoy, to remember, to hope, to survive.",
        merchant:       "GENERAL STORE - A place to gather, to trade, to sell, to gossip, to barter, to buy, to touch, to smell.",

        leaderBase:     "HEADQUARTERS - A place to command from, to plan, to gather, to regroup.",
        shepherd:       "RETREAT - A place to rest, to meditate, to think, to pray, to contemplate, to debate, to discuss, to question, to hope.",

        muscleBase:     "TRAINING AREA - A place to work out in, to move, to strengthen, to fight.",

        scientistBase:  "LAB - A place to investigate from, to hypothesize, to test, to experiment.",
        medic:          "INFIRMARY - A place to help from, to heal from, to look after, to administer, to diagnose, to medicate, to triage.",

        specialistBase: "RESEARCH ROOM - A place to solve from, to learn, to grow, to assist.",
        pilot:          "HANGER - A place to fly from, to attack from, to flee to, to protect, to escape, to dream.",
        weaponsExpert:  "ARMORY - A place to stockpile, to defend, to engage, to ready up, to attack from, to survive.",

        stowawayBase:   "SECRET ROOM - A place to hide, to plot, to escape, to maintain, to store.",

        technicianBase: "WORKROOM - A place to repair, to rebuild, to design, to destroy, to work.",
        engineer:       "WORKROOM - A place to repair, to rebuild, to design, to destroy, to work.\r\n\r\n\
Your space is your sanctuary, and you keep all the things you need in it. Pick two from the following list to upgrade your Workroom (delete the other options and this paragraph to make it fit in this field):\r\n\r\n\
Clean-room: +1 to +tech when Repairing an Advanced Item in your workroom\r\n\r\n\
Extensive database: +1 when trying to Assist in your space\r\n\r\n\
Portable space-ready work kit: +1 to +tech when Repairing while wearing an EVA suit\r\n\r\n\
VR Room: +1 to +group when trying to Influence Someone in your workroom",

        hacker:         "SERVER ROOM - A place to connect from, to integrate, to bypass, to decode, to encrypt, to block, to maintain.\r\n\r\n\
Your space is your sanctuary, and you keep all the things you need in it. Pick two from the following list to upgrade your Workroom (delete the other options and this paragraph to make it fit in this field):\r\n\r\n\
Wall of monitors: +1 to +head when trying to Survey a Scene from your space\r\n\r\n\
Advanced cooling system: +1 to +tech when repairing broken computer parts\r\n\r\n\
The latest software: +1 to +tech when Use an Advanced Item in your space\r\n\r\n\
Gaming console: +1 to +group when trying to Influence Someone in your server room",

        mechanic:       "WORKROOM - A place to repair, to rebuild, to design, to destroy, to work.\r\n\r\n\
Your space is your sanctuary, and you keep all the things you need in it. Pick two from the following list to upgrade your workroom (delete the other options and this paragraph to make it fit in this field):\r\n\r\n\
Jeweler's bench: +1 to +tech rolls when repairing small mechanical items\r\n\r\n\
Repair bay: +1 to +tech when repairing vehicles\r\n\r\n\
Modification station: +1 to +tech when attempting to modify a mechanical item\r\n\r\n\
Minifridge: +1 to +group when trying to Influence Someone in your workroom"
    };

    // Skill point options
    const skillsInfo = {
        augmented: {
            augmented1: { head: "+0", hand: "+2", heart: "+0", group: "+1", tech: "+1" },
            augmented2: { head: "+2", hand: "+1", heart: "+0", group: "-2", tech: "+1" },
            augmented3: { head: "+1", hand: "+2", heart: "-1", group: "+0", tech: "-1" },
            augmented4: { head: "-1", hand: "+2", heart: "-2", group: "+2", tech: "+0" },
            augmented5: { head: "+1", hand: "+1", heart: "+0", group: "+1", tech: "+0" }
        },
        civilian: {
            civilian1: { head: "+1", hand: "+0", heart: "+2", group: "+0", tech: "-1" },
            civilian2: { head: "+0", hand: "+1", heart: "+2", group: "+0", tech: "-1" },
            civilian3: { head: "+0", hand: "+0", heart: "+2", group: "+1", tech: "+1" },
            civilian4: { head: "-1", hand: "-1", heart: "+1", group: "+2", tech: "+0" },
            civilian5: { head: "+1", hand: "-2", heart: "+0", group: "+2", tech: "+1" }
        },

        leader: {
            leader1: { head: "+2", hand: "+0", heart: "+0", group: "+1", tech: "+1" },
            leader2: { head: "+2", hand: "+0", heart: "+1", group: "+0", tech: "+1" },
            leader3: { head: "-2", hand: "+2", heart: "-1", group: "+2", tech: "+0" },
            leader4: { head: "+1", hand: "+0", heart: "+2", group: "+2", tech: "-1" },
            leader5: { head: "-1", hand: "+2", heart: "+2", group: "-1", tech: "+0" }
        },

        muscle: {
            muscle1: { head: "+0", hand: "+2", heart: "+2", group: "-2", tech: "+0" },
            muscle2: { head: "+1", hand: "+2", heart: "+0", group: "+0", tech: "-1" },
            muscle3: { head: "+2", hand: "+1", heart: "+0", group: "-1", tech: "-1" },
            muscle4: { head: "-1", hand: "+2", heart: "+2", group: "+1", tech: "-2" },
            muscle5: { head: "+2", hand: "+0", heart: "-1", group: "+2", tech: "+0" }
        },

        scientist: {
            scientist1: { head: "+2", hand: "-2", heart: "-1", group: "+1", tech: "+1" },
            scientist2: { head: "+2", hand: "+0", heart: "-1", group: "+1", tech: "+2" },
            scientist3: { head: "+1", hand: "+1", heart: "+0", group: "-1", tech: "+1" },
            scientist4: { head: "+0", hand: "-1", heart: "+2", group: "-1", tech: "+2" },
            scientist5: { head: "-1", hand: "+1", heart: "+2", group: "-1", tech: "+2" }
        },

        specialist: {
            specialist1: { head: "+2", hand: "+0", heart: "-1", group: "-1", tech: "+2" },
            specialist2: { head: "+1", hand: "-1", heart: "+0", group: "+0", tech: "+2" },
            specialist3: { head: "+2", hand: "+1", heart: "+0", group: "-2", tech: "+0" },
            specialist4: { head: "+0", hand: "+2", heart: "-2", group: "+0", tech: "+2" },
            specialist5: { head: "-2", hand: "+2", heart: "+1", group: "+1", tech: "+0" }
        },

        stowaway: {
            stowaway1: { head: "+2", hand: "+0", heart: "+1", group: "+0", tech: "-1" },
            stowaway2: { head: "+0", hand: "+2", heart: "+1", group: "-1", tech: "-1" },
            stowaway3: { head: "-1", hand: "+1", heart: "+2", group: "+0", tech: "-1" },
            stowaway4: { head: "+2", hand: "+0", heart: "+2", group: "-1", tech: "-2" },
            stowaway5: { head: "+0", hand: "+2", heart: "-1", group: "-2", tech: "+2" }
        },

        technician: {
            technician1: { head: "+2", hand: "+0", heart: "-1", group: "+0", tech: "+2" },
            technician2: { head: "+1", hand: "-1", heart: "+0", group: "+0", tech: "+2" },
            technician3: { head: "+3", hand: "-1", heart: "-1", group: "+0", tech: "+1" },
            technician4: { head: "+1", hand: "+1", heart: "+1", group: "+0", tech: "+0" },
            technician5: { head: "-2", hand: "+1", heart: "+1", group: "+0", tech: "+1" }
        }
    };

    on('change:variant', function(eventInfo) {
        // console.log(eventInfo);
        if (typeof spaceInfo[eventInfo.newValue] != "undefined") {
            setAttrs({ "space": spaceInfo[eventInfo.newValue] });
        } else {
            getAttrs(["archetype"], function(value) {
                // console.log(value);
                var defaultValue = value.archetype + "Base";
                setAttrs({ "space": spaceInfo[defaultValue] });
            });
        };
    });

    on('change:skill_points', function(eventInfo) {
        // console.log(eventInfo);
        getAttrs(["archetype"], function(choice) {
            // console.log(choice);
            if(eventInfo.newValue != "blank") {
                selection = skillsInfo[choice.archetype][eventInfo.newValue];
                setAttrs({ "head": selection.head, "hand": selection.hand, "heart": selection.heart, "group": selection.group, "tech": selection.tech });
            };
        });
    });

    intuitionValues.forEach(function(value) {
        // console.log(value);
        on(`clicked:intuition_${value}`, function() {
            updateAttributes("intuition", value, intuitionValues);
        });
    });

    harmValues.forEach(function(value) {
        // console.log(value);
        on(`clicked:harm_${value}`, function() {
            updateAttributes("harm", value, harmValues);
        });
    });

    stressValues.forEach(function(value) {
        // console.log(value);
        on(`clicked:stress_${value}`, function() {
            updateAttributes("stress", value, stressValues);
        });
    });

    function updateAttributes(key, value, range) {
        // console.log("Key: " + key + " Value: " + " Range: " + range);
        getAttrs([key], function(level) {
            // console.log(level);
            if (level[key] == 1) {
                if (value == 1) {
                    value = 0;
                };
            };
            setAttrs({ [key]: value });
            range.forEach(function(count) {
                // console.log(count);
                if (value >= count) {
                    let selector = key + count;
                    setAttrs({ [selector]: "on" });
                } else {
                    let selector = key + count;
                    setAttrs({ [selector]: "off" });
                };
            });
        });
    };

    on('change:move1 change:move2 change:move3 change:move4', function(eventInfo) {
        // console.log(eventInfo);
        if (eventInfo.sourceType == "player") {
            if (eventInfo.newValue == "on") {
                getAttrs(["move_limit"], function(limit) {
                    if (limit.move_limit == 2) {
                        setAttrs({ [eventInfo.sourceAttribute]: "0" });
                    } else if (limit.move_limit != "") {
                        if (limit.move_limit < 2) {
                            setAttrs({ move_limit: limit.move_limit + 1 });
                        };
                    } else {
                        setAttrs({ move_limit: 1 });
                    };
                });
            } else if (eventInfo.newValue == "0") {
                getAttrs(["move_limit"], function(limit) {
                    // console.log(limit);
                    if (limit.move_limit > 0) {
                        setAttrs({ move_limit: limit.move_limit - 1 });
                    };
                });
            };
        };
    });

</script>