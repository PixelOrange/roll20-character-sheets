<div class="flex-section">
    <div class="col1">
        <div class="name">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/name.png"><br />
            <input type="text" name="attr_character" class="character-name" />
        </div>
        <div class="attitude">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/attitude.png"><br />
            <input type="text" name="attr_attitude" class="attitude" />
        </div><br /><br />
        <div class="archetype">
            <select name="attr_archetype" class="archetype">
                <option value="blank">{Archetype}</option>
                <option value="augmented">The Augmented</option>
                <option value="civilian">The Civilian</option>
                <option value="leader">The Leader</option>
                <option value="muscle">The Muscle</option>
                <option value="scientist">The Scientist</option>
                <option value="specialist">The Specialist</option>
                <option value="stowaway">The Stowaway</option>
                <option value="technician">The Technician</option>
            </select>
            <!-- These checkboxes determine which dropdown will appear for the variants -->
            <input type="checkbox" name="attr_archetype" class="toggle augmented-toggle" value="augmented" />
            <input type="checkbox" name="attr_archetype" class="toggle civilian-toggle" value="civilian" />
            <input type="checkbox" name="attr_archetype" class="toggle leader-toggle" value="leader" />
            <input type="checkbox" name="attr_archetype" class="toggle muscle-toggle" value="muscle" />
            <input type="checkbox" name="attr_archetype" class="toggle scientist-toggle" value="scientist" />
            <input type="checkbox" name="attr_archetype" class="toggle specialist-toggle" value="specialist" />
            <input type="checkbox" name="attr_archetype" class="toggle stowaway-toggle" value="stowaway" />
            <input type="checkbox" name="attr_archetype" class="toggle technician-toggle" value="technician" />
            <!-- Variant Options -->
            <div class="variant augmented">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="almost-human">The Almost-Human</option>
                    <option value="construct">The Construct</option>
                    <option value="cyborg">The Cyborg</option>
                </select>
            </div>
            <div class="variant civilian">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="entertainer">The Entertainer</option>
                    <option value="homesteader">The Homesteader</option>
                    <option value="merchant">The Merchant</option>
                </select>
            </div>
            <div class="variant leader">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="commander">The Commander</option>
                    <option value="diplomat">The Diplomat</option>
                    <option value="shepherd">The Shepherd</option>
                </select>
            </div>
            <div class="variant muscle">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="ex-marine">The Ex-Marine</option>
                    <option value="miner">The Miner</option>
                    <option value="security">The Security</option>
                </select>
            </div>
            <div class="variant scientist">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="biologist">The Biologist</option>
                    <option value="chemist">The Chemist</option>
                    <option value="medic">The Medic</option>
                </select>
            </div>
            <div class="variant specialist">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="academic">The Academic</option>
                    <option value="pilot">The Pilot</option>
                    <option value="weapons-expert">The Weapons Expert</option>
                </select>
            </div>
            <div class="variant stowaway">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="criminal">The Criminal</option>
                    <option value="kid">The Kid</option>
                    <option value="survivor">The Survivor</option>
                </select>
            </div>
            <div class="variant technician">
                <select name="attr_variant" class="variant">
                    <option value="blank">{Variant}</option>
                    <option value="base">Base</option>
                    <option value="engineer">The Engineer</option>
                    <option value="Hacker">The Hacker</option>
                    <option value="mechanic">The Mechanic</option>
                </select>
            </div>

        </div>
        <div class="appearance">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/appearance.png"><br />
            <textarea name="attr_appearance" class="attr-appearance"></textarea>
        </div>
        <div class="space">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/space.png"><br />
            <div name="attr_space" class="attr-space"></div>
        </div>
        <div class="notes">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/notes.png"><br />
            <textarea name="attr_notes" class="attr-notes"></textarea>
        </div>
    </div>
    <div class='col2'>
        <div class="stats">
            <img class="statblock" src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/stats.png">
            <span class="head-text">Planning<br />Intelligence</span>
            <input type="number" name="attr_head" class="head" />
            <span class="hand-text">Strength<br />Combat</span>
            <input type="number" name="attr_hand" class="hand" />
            <span class="heart-text">Stability<br />Empathy</span>
            <input type="number" name="attr_heart" class="heart" />
            <span class="group-text">Negotiation<br />Networking</span>
            <input type="number" name="attr_group" class="group" />
            <span class="tech-text">Abilities<br />Use Items</span>
            <input type="number" name="attr_tech" class="tech" />
        </div>
        <br />
        <div class="intuition">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/intuition.png"><br />
            <p class="intuition-description">Remove an Intuition to change a roll
                <br />to an Incredible Success or to avoid
                <br />all harm in one event.</p>
            <span>GOOD</span>
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="1" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="2" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="3" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="4" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="5" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="6" />
            <input type="checkbox" name="attr_intuition" class="intuition-selector" value="7" />
            <span class="done-for">DONE FOR</span>
        </div>
        <div class="harm-stress">
            <img src="https://raw.githubusercontent.com/PixelOrange/roll20-character-sheets/master/Starhold/Images/harmstress.png"><br />
            <p class="harm-description">Mark a harm when youâ€™re injured.
                <br>At 5 harm you are unstable.</p>
            <span>HEALTHY</span>
            <button type="action" name="act_harm_1" class="harm-selector"></button>
            <button type="action" name="act_harm_2" class="harm-selector"></button>
            <button type="action" name="act_harm_3" class="harm-selector"></button>
            <button type="action" name="act_harm_4" class="harm-selector"></button>
            <button type="action" name="act_harm_5" class="harm-selector"></button>
            <button type="action" name="act_harm_6" class="harm-selector"></button>
            <button type="action" name="act_harm_7" class="harm-selector"></button>
            <input type="checkbox" name="attr_harm1" class="harm-display" />
            <input type="checkbox" name="attr_harm2" class="harm-display" />
            <input type="checkbox" name="attr_harm3" class="harm-display" />
            <input type="checkbox" name="attr_harm4" class="harm-display" />
            <input type="checkbox" name="attr_harm5" class="harm-display" />
            <input type="checkbox" name="attr_harm6" class="harm-display" />
            <input type="checkbox" name="attr_harm7" class="harm-display" />
            <span class="dying">DYING</span>
            <br /><br />
            <p class="stress-description">Mark a stress when directed.
                <br />Erase a mark after downtime.
                <br />After the 5th stress mark,
                <br />you are panicked.</p>
            <span>ALRIGHT</span>
            <input type="checkbox" name="attr_stress" class="stress-selector" value="1" />
            <input type="checkbox" name="attr_stress" class="stress-selector" value="2" />
            <input type="checkbox" name="attr_stress" class="stress-selector" value="3" />
            <input type="checkbox" name="attr_stress" class="stress-selector" value="4" />
            <input type="checkbox" name="attr_stress" class="stress-selector" value="5" />
            <span class="exhausted">EXHAUSTED</span>
        </div>
    </div>
</div>

<script type="text/worker">
    const harmValues = ["1","2","3","4","5","6","7"];
    harmValues.forEach(function(value) {
        on(`clicked:harm_${value}`, function() {
            getAttrs(["harm"], function(level) {
                let setValue = value;
                console.log("Harm Level: " + level.harm);
                console.log("Value: " + value);
                if (level.harm == 1) {
                    console.log("If Statement Value: " + value);
                    if (value == 1) {
                        setValue = 0;
                    };
                };
                setAttrs({ "harm": setValue });
                updateDisplay("harm", setValue, harmValues);
            });
        });
    });

    function updateDisplay(name,value,range) {
        console.log("Update value: " + value);
        range.forEach(function(count) {
            if (value >= count) {
                let selector = name + count;
                console.log(selector);
                setAttrs({ [selector]: "on" });
            } else {
                let selector = name + count;
                console.log(selector);
                setAttrs({ [selector]: "off" });
            };
        });
    };
</script>